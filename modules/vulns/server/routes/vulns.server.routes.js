'use strict';

/**
 * Module dependencies
 */
var vulnsPolicy = require('../policies/vulns.server.policy'),
  vulns = require('../controllers/vulns.server.controller');

module.exports = function(app) {
  // Vulns Routes
  app.route('/api/vulns').all(vulnsPolicy.isAllowed)
    .get(vulns.list)
    .post(vulns.create);

  app.route('/api/vulns/:vulnId').all(vulnsPolicy.isAllowed)
    .get(vulns.read)
    .put(vulns.update)
    .delete(vulns.delete);

  // Finish by binding the Vuln middleware
  app.param('vulnId', vulns.vulnByID);
};
